<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Using a unique taxon name (mapped to genbank with rentrez), you can download all the genbank sequences from that taxon (using phylotaR), cluster by gene (phylotaR), align (using mafft), throw out clusters that don't have enough sequences, delete gappy columns, make partition files, and make a tree (using raxml). ">
<title>From a clade name, download sequences and make a tree • taxon2tree</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="From a clade name, download sequences and make a tree">
<meta property="og:description" content="Using a unique taxon name (mapped to genbank with rentrez), you can download all the genbank sequences from that taxon (using phylotaR), cluster by gene (phylotaR), align (using mafft), throw out clusters that don't have enough sequences, delete gappy columns, make partition files, and make a tree (using raxml). ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">taxon2tree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="taxon2tree">taxon2tree<a class="anchor" aria-label="anchor" href="#taxon2tree"></a>
</h1></div>
<p>Workflow to make a tree from a taxon, leaning heavily on <a href="https://github.com/ropensci/phylotaR" class="external-link">phylotaR</a>, plus some scripts around it to make it slightly easier (making partition files, eliminating gappy sites, throwing out clusters of genes without enough taxa, etc.). See website at <a href="https://bomeara.github.io/taxon2tree/" class="external-link uri">https://bomeara.github.io/taxon2tree/</a>.</p>
<p>If you use this, please cite the papers for phylotaR:</p>
<ul>
<li>Bennett, D., Hettling, H., Silvestro, D., Zizka, A., Bacon, C., Faurby, S., … Antonelli, A. (2018). phylotaR: An Automated Pipeline for Retrieving Orthologous DNA Sequences from GenBank in R. Life, 8(2), 20. <a href="DOI:10.3390/life8020020" class="uri">DOI:10.3390/life8020020</a>
</li>
<li>Sanderson, M. J., Boss, D., Chen, D., Cranston, K. A., &amp; Wehe, A. (2008). The PhyLoTA Browser: Processing GenBank for molecular phylogenetics research. Systematic Biology, 57(3), 335–346. <a href="DOI:10.1080/10635150802158688" class="uri">DOI:10.1080/10635150802158688</a>
</li>
</ul>
<p>You can also cite the taxon2tree package.</p>
<p><strong>Note that any errors likely come from this package, not from phylotaR.</strong></p>
<p>To run, the basic approach is to install it:</p>
<pre><code><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"bomeara/taxon2tree"</span><span class="op">)</span></code></pre>
<p>and then use it:</p>
<pre><code><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">taxon2tree</span><span class="op">)</span>
<span class="fu"><a href="reference/BatchRun.html">BatchRun</a></span><span class="op">(</span><span class="st">"Myrmecocystus"</span><span class="op">)</span></code></pre>
<p>It will make a bunch of folders in the current working directory:</p>
<ul>
<li>
<code>phylotaR_run</code>: the folder with the raw phylotaR results</li>
<li>
<code>seqs_raw</code>: the original clusters (sets of putative genes)</li>
<li>
<code>seqs_processed</code>: clusters grouped by gene name, a grouping of <code>seqs_raw</code> clusters</li>
<li>
<code>seqs_gappy_removed</code>: clusters with gappy sites removed, a further processing of <code>seqs_processed</code>
</li>
<li>
<code>seqs_final</code>: The final matrix with all sequences combined; it also has two partition files for raxml:
<ul>
<li>
<code>partition.txt</code>: Partitions for mtDNA, cpDNA, 18S, 28S, with everything else put in an additional partition.</li>
<li>
<code>partition_bygene.txt</code>: Each putative gene in its own partition</li>
</ul>
</li>
<li>
<code>_targets</code>: This uses the <a href="https://books.ropensci.org/targets/" class="external-link">targets</a> workflow in R to help with the batch processing. If a later step is misconfigured and fails, you can correct it, tell the workflow to start again from that point (i.e., <code>targets::tar_invalidate(raxmlrun)</code> if you want to redo the raxml step), call <code><a href="reference/BatchRun.html">BatchRun()</a></code> again [with your taxon name], and the workflow will pick up where it left off.</li>
</ul>
<p>There is also a <code>seqs_direct_download</code> folder; if you want to download a fasta file of mitochondrial genomes, you can put it there as <code>mtgenomes.fasta</code> and then rerun the workflow (<code>targets::tar_invalidate('process_genes')</code> and then rerun using <code><a href="reference/BatchRun.html">BatchRun()</a></code>.</p>
<p>However, a lot happens under the hood. To run, you must have:</p>
<p><code>install.packages("ape","phangorn", "phylotaR", "rentrez", "targets")</code></p>
<p>You also must have <a href="https://bioconductor.org/packages/release/bioc/html/Biostrings.html" class="external-link"><code>Biostrings</code></a> from Bioconductor installed:</p>
<pre><code><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>

<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"Biostrings"</span><span class="op">)</span></code></pre>
<p>You also must have NCBI tools (for BLAST) and raxml installed. Install NCBI tools from <a href="https://www.ncbi.nlm.nih.gov/books/NBK279690/" class="external-link">here</a>. For raxml, you can install from <a href="https://cme.h-its.org/exelixis/web/software/raxml/" class="external-link">here</a> but perhaps easier is using <a href="https://brew.sh/" class="external-link">homebrew</a>. First install homebrew, then <code>brew install brewsci/bio/raxml</code>.</p>
<p>You will also need to know the paths for these tools. By default, the program assumes that <code>raxmlHPC</code> is in your path, but that could be wrong. If you go into a terminal window, and start typing raxml and hit tab, you should see the installed versions. Pick one, then in terminal type <code>which raxmlXXX</code> where XXX is your raxml name (i.e., raxmlHPC-SS3) and it will tell you the path to it. You could then run the workflow with, for example <code>BatchRun("Myrmecocystus", raxml="/usr/local/bin/raxmlHPC-SSE3")</code> to use that install of raxml. Similarly, the folder with NCBI tools is assumed to be <code>/usr/local/bin</code> (the location of the tools, not the applications themselves), but you can change this with the <code>ncbi_path</code> argument to <code><a href="reference/BatchRun.html">BatchRun()</a></code>.</p>
<p><strong>If all works well <code>seqs_final</code> should have the output of your raxml runs, including <code>RAxML_bestTree.combined</code>, bootstrap trees and more.</strong></p>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing taxon2tree</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Brian O'Meara <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0337-5997" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Brian O’Meara.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
